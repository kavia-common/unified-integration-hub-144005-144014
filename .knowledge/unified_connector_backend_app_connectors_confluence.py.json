{"is_source_file": true, "format": "Python", "description": "This source file implements a Confluence connector class for interacting with Atlassian Confluence via OAuth and REST API. It contains functions for OAuth authentication, searching content, creating pages, and listing spaces, with external dependencies on httpx, environment variables, and internal modules for security and database operations.", "external_files": ["../db/mongo", "../security/crypto", "./base"], "external_methods": ["get_oauth_config", "upsert_connection", "get_connection", "encrypt_str", "decrypt_str"], "published": ["ConfluenceConnector"], "classes": [{"name": "ConfluenceConnector", "description": "A class that provides methods to authenticate, search, create, and list spaces in Confluence via its REST API, supporting OAuth authentication flow and token management."}], "methods": [{"name": "Optional[Dict[str,str]] _get_dynamic_oauth(tenant_id: str)", "description": "Fetches OAuth configuration dynamically from the database for a given tenant.", "scope": "", "scopeKind": ""}, {"name": "_env_client_id()", "description": "Reads the Confluence client ID from environment variables.", "scope": "", "scopeKind": ""}, {"name": "_env_client_secret()", "description": "Reads the Confluence client secret from environment variables.", "scope": "", "scopeKind": ""}, {"name": "_env_redirect_uri()", "description": "Reads the redirect URI for OAuth from environment variables.", "scope": "", "scopeKind": ""}, {"name": "OAuthAuthorize get_oauth_authorize_url(self, tenant_id: str, state: str)", "description": "Generates the OAuth authorization URL for Confluence OAuth flow.", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"name": "Dict[str,Any] exchange_code_for_tokens(self, tenant_id: str, code: str, state: str)", "description": "Exchanges an OAuth authorization code for access and refresh tokens, storing them securely.", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"name": "Dict[str,Any] _get_auth(self, tenant_id: str)", "description": "Retrieves and decrypts stored OAuth tokens for a tenant.", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"name": "search(self, tenant_id: str, query: str, resource: str, page: int = 1, per_page: int = 20)", "description": "Performs a search query on Confluence content using the API.", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"name": "CreateResult create(self, tenant_id: str, resource: str, payload: Dict[str, Any])", "description": "Creates a new Confluence page with specified title, space, and body.", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"name": "list_supporting(self, tenant_id: str, resource: str)", "description": "Lists available spaces in Confluence when resource is 'spaces'.", "scope": "ConfluenceConnector", "scopeKind": "class"}], "calls": ["get_oauth_config", "upsert_connection", "get_connection", "encrypt_str", "decrypt_str", "httpx.AsyncClient", "res.raise_for_status", "res.json"], "search-terms": ["Confluence OAuth", "Confluence REST API", "OAuth authorization URL", "Token exchange", "Create Confluence page", "Search in Confluence", "List Confluence spaces", "async Python Confluence connector"], "state": 2, "file_id": 10, "knowledge_revision": 48, "git_revision": "2539d54dd1667971fa4bf833ba0fc9e29cf31bd2", "revision_history": [{"21": ""}, {"48": "2539d54dd1667971fa4bf833ba0fc9e29cf31bd2"}], "ctags": [{"_type": "tag", "name": "CONF_API_ROOT", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^CONF_API_ROOT = \"https:\\/\\/api.atlassian.com\\/ex\\/confluence\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "CONF_AUTH_URL", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^CONF_AUTH_URL = \"https:\\/\\/auth.atlassian.com\\/authorize\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "CONF_TOKEN_URL", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^CONF_TOKEN_URL = \"https:\\/\\/auth.atlassian.com\\/oauth\\/token\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ConfluenceConnector", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^class ConfluenceConnector(BaseConnector):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SCOPES", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^SCOPES = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_dec", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^from ..security.crypto import encrypt_str, decrypt_str, decrypt_str as _dec$/", "language": "Python", "kind": "unknown", "nameref": "unknown:decrypt_str"}, {"_type": "tag", "name": "_env_client_id", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^def _env_client_id():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_env_client_secret", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^def _env_client_secret():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_env_redirect_uri", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^def _env_redirect_uri():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_get_auth", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    async def _get_auth(self, tenant_id: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, tenant_id: str)", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "_get_dynamic_oauth", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^async def _get_dynamic_oauth(tenant_id: str) -> Optional[Dict[str, str]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,str]]", "kind": "function", "signature": "(tenant_id: str)"}, {"_type": "tag", "name": "create", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    async def create(self, tenant_id: str, resource: str, payload: Dict[str, Any]) -> CreateResu/", "language": "Python", "typeref": "typename:CreateResult", "kind": "member", "signature": "(self, tenant_id: str, resource: str, payload: Dict[str, Any])", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "display_name", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    display_name = \"Confluence\"$/", "language": "Python", "kind": "variable", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "exchange_code_for_tokens", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    async def exchange_code_for_tokens(self, tenant_id: str, code: str, state: str) -> Dict[str,/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, tenant_id: str, code: str, state: str)", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "get_oauth_authorize_url", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    async def get_oauth_authorize_url(self, tenant_id: str, state: str) -> OAuthAuthorize:$/", "language": "Python", "typeref": "typename:OAuthAuthorize", "kind": "member", "signature": "(self, tenant_id: str, state: str)", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    id = \"confluence\"$/", "language": "Python", "kind": "variable", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "list_supporting", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    async def list_supporting(self, tenant_id: str, resource: str):$/", "language": "Python", "kind": "member", "signature": "(self, tenant_id: str, resource: str)", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "required_scopes", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    required_scopes = SCOPES$/", "language": "Python", "kind": "variable", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "search", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    async def search(self, tenant_id: str, query: str, resource: str, page: int = 1, per_page: i/", "language": "Python", "kind": "member", "signature": "(self, tenant_id: str, query: str, resource: str, page: int = 1, per_page: int = 20)", "scope": "ConfluenceConnector", "scopeKind": "class"}, {"_type": "tag", "name": "supports_oauth", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/connectors/confluence.py", "pattern": "/^    supports_oauth = True$/", "language": "Python", "kind": "variable", "scope": "ConfluenceConnector", "scopeKind": "class"}], "hash": "ba61be2d03775990998c8cb1b50f8c28", "format-version": 4, "code-base-name": "unified_connector_backend", "filename": "unified_connector_backend/app/connectors/confluence.py", "fields": [{"name": "CONF_API_ROOT = \"https:\\/\\/api.atlassian.com\\/ex\\/confluence\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "CONF_AUTH_URL = \"https:\\/\\/auth.atlassian.com\\/authorize\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "CONF_TOKEN_URL = \"https:\\/\\/auth.atlassian.com\\/oauth\\/token\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SCOPES = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "display_name = \"Confluence\"", "scope": "ConfluenceConnector", "scopeKind": "class", "description": "unavailable"}, {"name": "id = \"confluence\"", "scope": "ConfluenceConnector", "scopeKind": "class", "description": "unavailable"}, {"name": "required_scopes = SCOPES", "scope": "ConfluenceConnector", "scopeKind": "class", "description": "unavailable"}, {"name": "supports_oauth = True", "scope": "ConfluenceConnector", "scopeKind": "class", "description": "unavailable"}]}