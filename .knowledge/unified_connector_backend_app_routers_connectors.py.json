{"is_source_file": true, "format": "Python", "description": "This source file defines API routes for managing connectors, including OAuth flows, resource search, and project/space listing for Jira and Confluence. It utilizes FastAPI's APIRouter to create RESTful endpoints, manages connector instances, and handles interaction with external services via imported connector classes.", "external_files": ["../connectors/registry", "../connectors/jira", "../connectors/confluence", "../db/mongo", "../security/crypto"], "external_methods": ["make_connectors_router", "get_connector", "get_tenant", "list_connectors", "delete_connection", "upsert_oauth_config", "encrypt_str"], "published": ["/connectors/{connector_id}/oauth/login", "/connectors/{connector_id}/oauth/callback", "/connectors/{connector_id}/search", "/connectors/jira/issues", "/connectors/confluence/pages", "/connectors/jira/projects", "/connectors/confluence/spaces", "/connectors/{connector_id}/connection", "/connectors/jira/configure", "/connectors/confluence/configure"], "classes": [{"name": "OAuthLoginResponse", "description": "Response model containing the OAuth authorize URL and CSRF state token."}, {"name": "OAuthCallbackResponse", "description": "Simple response indicating OAuth callback was processed successfully."}, {"name": "SearchResponse", "description": "Model for search results containing a list of items."}, {"name": "OAuthConfigPayload", "description": "Payload model for saving OAuth client credentials."}, {"name": "JiraCreateIssue", "description": "Model for creating a Jira issue with project key, summary, and optional description."}, {"name": "ConfluenceCreatePage", "description": "Model for creating a Confluence page with space key, title, and body."}], "methods": [{"name": "oauth_login(connector_id: str, return_url: Optional[str] = Query(None), tenant: TenantContext = Depends(get_tenant))", "description": "Initiates OAuth login by generating a CSRF token, storing state, and returning the provider's authorization URL.", "scope": "", "scopeKind": ""}, {"name": "oauth_callback(connector_id: str, code: str = Query(...), state: str = Query(...))", "description": "Handles OAuth provider callback to exchange code for tokens and validate state.", "scope": "", "scopeKind": ""}, {"name": "search(connector_id: str, q: str = Query(..., description=\"Query string\"), resource: str = Query(..., description=\"Resource type\"), page: int = 1, per_page: int = 20, tenant: TenantContext = Depends(get_tenant))", "description": "Performs a resource search for a specific connector with normalized results.", "scope": "", "scopeKind": ""}, {"name": "create_jira_issue(payload: JiraCreateIssue, tenant: TenantContext = Depends(get_tenant))", "description": "Creates a Jira issue using provided project key, summary, and description.", "scope": "", "scopeKind": ""}, {"name": "create_conf_page(payload: ConfluenceCreatePage, tenant: TenantContext = Depends(get_tenant))", "description": "Creates a Confluence page with given space key, title, and body.", "scope": "", "scopeKind": ""}, {"name": "delete_conn(connector_id: str, tenant: TenantContext = Depends(get_tenant))", "description": "Deletes stored connector connection credentials and revokes access.", "scope": "", "scopeKind": ""}, {"name": "list_jira_projects(tenant: TenantContext = Depends(get_tenant))", "description": "Lists Jira projects supported by the Jira connector.", "scope": "", "scopeKind": ""}, {"name": "list_conf_spaces(tenant: TenantContext = Depends(get_tenant))", "description": "Lists Confluence spaces supported by the Confluence connector.", "scope": "", "scopeKind": ""}, {"name": "configure_jira(payload: OAuthConfigPayload, tenant: TenantContext = Depends(get_tenant))", "description": "Stores Jira OAuth client configuration, encrypting sensitive data.", "scope": "", "scopeKind": ""}, {"name": "configure_confluence(payload: OAuthConfigPayload, tenant: TenantContext = Depends(get_tenant))", "description": "Stores Confluence OAuth client configuration, encrypting sensitive data.", "scope": "", "scopeKind": ""}], "calls": ["get_connector", "get_tenant", "connector.get_oauth_authorize_url", "connector.exchange_code_for_tokens", "connector.search", "JIRA.create", "CONFLUENCE.create", "list_supporting", "delete_connection", "upsert_oauth_config", "encrypt_str"], "search-terms": ["OAuth", "connectors", "Jira", "Confluence", "OAuth login", "resource search", "project list", "space list", "configure OAuth client"], "state": 2, "file_id": 11, "knowledge_revision": 46, "git_revision": "2539d54dd1667971fa4bf833ba0fc9e29cf31bd2", "revision_history": [{"23": ""}, {"44": "2539d54dd1667971fa4bf833ba0fc9e29cf31bd2"}, {"45": "2539d54dd1667971fa4bf833ba0fc9e29cf31bd2"}, {"46": "2539d54dd1667971fa4bf833ba0fc9e29cf31bd2"}], "ctags": [{"_type": "tag", "name": "CONFLUENCE", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^CONFLUENCE = ConfluenceConnector()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ConfluenceCreatePage", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^class ConfluenceCreatePage(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "JIRA", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^JIRA = JiraConnector()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "JiraCreateIssue", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^class JiraCreateIssue(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OAuthCallbackResponse", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^class OAuthCallbackResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OAuthConfigPayload", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^class OAuthConfigPayload(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OAuthLoginResponse", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^class OAuthLoginResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "STATE_STORE", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^STATE_STORE: Dict[str, str] = {}$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable"}, {"_type": "tag", "name": "SearchResponse", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^class SearchResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "authorize_url", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    authorize_url: str = Field(..., description=\"URL to redirect user for provider OAuth\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OAuthLoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    body: Optional[str] = Field(\"\", description=\"Page body (storage)\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "ConfluenceCreatePage", "scopeKind": "class"}, {"_type": "tag", "name": "client_id", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    client_id: str = Field(..., description=\"OAuth client ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OAuthConfigPayload", "scopeKind": "class"}, {"_type": "tag", "name": "client_secret", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    client_secret: str = Field(..., description=\"OAuth client secret\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OAuthConfigPayload", "scopeKind": "class"}, {"_type": "tag", "name": "configure_confluence", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def configure_confluence(payload: OAuthConfigPayload, tenant: TenantContext = Depends(get_/", "language": "Python", "kind": "function", "signature": "(payload: OAuthConfigPayload, tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "configure_jira", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def configure_jira(payload: OAuthConfigPayload, tenant: TenantContext = Depends(get_tenant/", "language": "Python", "kind": "function", "signature": "(payload: OAuthConfigPayload, tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "create_conf_page", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def create_conf_page(payload: ConfluenceCreatePage, tenant: TenantContext = Depends(get_te/", "language": "Python", "kind": "function", "signature": "(payload: ConfluenceCreatePage, tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "create_jira_issue", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def create_jira_issue(payload: JiraCreateIssue, tenant: TenantContext = Depends(get_tenant/", "language": "Python", "kind": "function", "signature": "(payload: JiraCreateIssue, tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "delete_conn", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def delete_conn(connector_id: str, tenant: TenantContext = Depends(get_tenant)):$/", "language": "Python", "kind": "function", "signature": "(connector_id: str, tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    description: Optional[str] = Field(None, description=\"Issue description\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "JiraCreateIssue", "scopeKind": "class"}, {"_type": "tag", "name": "list_conf_spaces", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def list_conf_spaces(tenant: TenantContext = Depends(get_tenant)):$/", "language": "Python", "kind": "function", "signature": "(tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "list_jira_projects", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def list_jira_projects(tenant: TenantContext = Depends(get_tenant)):$/", "language": "Python", "kind": "function", "signature": "(tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "oauth_callback", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def oauth_callback(connector_id: str, code: str = Query(...), state: str = Query(...)):$/", "language": "Python", "kind": "function", "signature": "(connector_id: str, code: str = Query(...), state: str = Query(...))"}, {"_type": "tag", "name": "oauth_login", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def oauth_login(connector_id: str, return_url: Optional[str] = Query(None), tenant: Tenant/", "language": "Python", "kind": "function", "signature": "(connector_id: str, return_url: Optional[str] = Query(None), tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "project_key", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    project_key: str = Field(..., description=\"Jira project key\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "JiraCreateIssue", "scopeKind": "class"}, {"_type": "tag", "name": "redirect_uri", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    redirect_uri: str = Field(..., description=\"Registered redirect\\/callback URI\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OAuthConfigPayload", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "search", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^async def search(connector_id: str, q: str = Query(..., description=\"Query string\"), resource: s/", "language": "Python", "kind": "function", "signature": "(connector_id: str, q: str = Query(..., description=\"Query string\"), resource: str = Query(..., description=\"Resource type\"), page: int = 1, per_page: int = 20, tenant: TenantContext = Depends(get_tenant))"}, {"_type": "tag", "name": "space_key", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    space_key: str = Field(..., description=\"Confluence space key\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "ConfluenceCreatePage", "scopeKind": "class"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    state: str = Field(..., description=\"CSRF state\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OAuthLoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    status: str = \"ok\"$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OAuthCallbackResponse", "scopeKind": "class"}, {"_type": "tag", "name": "summary", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    summary: str = Field(..., description=\"Issue summary\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "JiraCreateIssue", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/routers/connectors.py", "pattern": "/^    title: str = Field(..., description=\"Page title\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "ConfluenceCreatePage", "scopeKind": "class"}], "hash": "8cb79923509ba977c769bc9a0d954e02", "format-version": 4, "code-base-name": "unified_connector_backend", "filename": "unified_connector_backend/app/routers/connectors.py", "fields": [{"name": "CONFLUENCE = ConfluenceConnector()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "JIRA = JiraConnector()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, str] STATE_STORE", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str authorize_url", "scope": "OAuthLoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] body", "scope": "ConfluenceCreatePage", "scopeKind": "class", "description": "unavailable"}, {"name": "str client_id", "scope": "OAuthConfigPayload", "scopeKind": "class", "description": "unavailable"}, {"name": "str client_secret", "scope": "OAuthConfigPayload", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] description", "scope": "JiraCreateIssue", "scopeKind": "class", "description": "unavailable"}, {"name": "str project_key", "scope": "JiraCreateIssue", "scopeKind": "class", "description": "unavailable"}, {"name": "str redirect_uri", "scope": "OAuthConfigPayload", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str space_key", "scope": "ConfluenceCreatePage", "scopeKind": "class", "description": "unavailable"}, {"name": "str state", "scope": "OAuthLoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str status", "scope": "OAuthCallbackResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str summary", "scope": "JiraCreateIssue", "scopeKind": "class", "description": "unavailable"}, {"name": "str title", "scope": "ConfluenceCreatePage", "scopeKind": "class", "description": "unavailable"}]}