{"is_source_file": true, "format": "Python", "description": "This file implements a thread-safe in-memory token and connection store for a multi-tenant system. It manages encrypted credentials per tenant and connector, providing methods for setting, retrieving, deleting, and listing connections. The store is ephemeral and supports optional AES-GCM encryption.", "external_files": [".security"], "external_methods": ["encrypt_blob", "decrypt_blob"], "published": ["token_store"], "classes": [{"name": "_Entry", "description": "Data model representing a stored connection/credential entry, including encryption and status information."}, {"name": "_MemoryStore", "description": "Internal class managing thread-safe storage of entries, with methods for CRUD operations and status retrieval."}], "methods": [{"name": "None set(self, tenant_id: str, connector_id: str, credentials: Dict[str, Any])", "description": "Stores credentials for a given tenant and connector, encrypting the data.", "scope": "_MemoryStore", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] get(self, tenant_id: str, connector_id: str)", "description": "Retrieves credentials for a given tenant and connector, decrypting and parsing them.", "scope": "_MemoryStore", "scopeKind": "class"}, {"name": "bool delete(self, tenant_id: str, connector_id: str)", "description": "Removes the stored credentials for a specified tenant and connector.", "scope": "_MemoryStore", "scopeKind": "class"}, {"name": "Optional[str] status(self, tenant_id: str, connector_id: str)", "description": "Returns the connection status of a specified tenant and connector.", "scope": "_MemoryStore", "scopeKind": "class"}, {"name": "Dict[str,str] list_connectors_for_tenant(self, tenant_id: str)", "description": "Lists all connectors and their statuses associated with a tenant.", "scope": "_MemoryStore", "scopeKind": "class"}, {"name": "_MemoryStore token_store()", "description": "Returns the singleton instance of the in-memory token store.", "scope": "", "scopeKind": ""}, {"name": "None __init__(self)", "scope": "_MemoryStore", "scopeKind": "class", "description": "unavailable"}], "calls": ["encrypt_blob", "decrypt_blob", "ast.literal_eval", "time.time", "self._lock.acquire()", "self._lock.release()"], "search-terms": ["thread-safe in-memory token store", "per-tenant, per-connector storage", "AES-GCM encryption", "ephemeral credentials", "connection status store"], "state": 2, "file_id": 14, "knowledge_revision": 38, "git_revision": "", "ctags": [{"_type": "tag", "name": "_Entry", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^class _Entry(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_MemoryStore", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^class _MemoryStore:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "_MemoryStore", "scopeKind": "class"}, {"_type": "tag", "name": "_store", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^_store = _MemoryStore()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "delete", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^    def delete(self, tenant_id: str, connector_id: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, tenant_id: str, connector_id: str)", "scope": "_MemoryStore", "scopeKind": "class"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^    def get(self, tenant_id: str, connector_id: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, tenant_id: str, connector_id: str)", "scope": "_MemoryStore", "scopeKind": "class"}, {"_type": "tag", "name": "last_refreshed", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^    last_refreshed: float = Field(default_factory=lambda: time.time())$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "_Entry", "scopeKind": "class"}, {"_type": "tag", "name": "list_connectors_for_tenant", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^    def list_connectors_for_tenant(self, tenant_id: str) -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "member", "signature": "(self, tenant_id: str)", "scope": "_MemoryStore", "scopeKind": "class"}, {"_type": "tag", "name": "set", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^    def set(self, tenant_id: str, connector_id: str, credentials: Dict[str, Any]) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, tenant_id: str, connector_id: str, credentials: Dict[str, Any])", "scope": "_MemoryStore", "scopeKind": "class"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^    def status(self, tenant_id: str, connector_id: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "member", "signature": "(self, tenant_id: str, connector_id: str)", "scope": "_MemoryStore", "scopeKind": "class"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^    status: str = \"connected\"$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "_Entry", "scopeKind": "class"}, {"_type": "tag", "name": "token_store", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/core/token_store.py", "pattern": "/^def token_store() -> _MemoryStore:$/", "language": "Python", "typeref": "typename:_MemoryStore", "kind": "function", "signature": "()"}], "hash": "184bc76ca06abe2943c02be2d71099ea", "format-version": 4, "code-base-name": "unified_connector_backend", "filename": "unified_connector_backend/app/core/token_store.py", "fields": [{"name": "_store = _MemoryStore()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "float last_refreshed", "scope": "_Entry", "scopeKind": "class", "description": "unavailable"}, {"name": "str status", "scope": "_Entry", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"38": ""}]}