{"is_source_file": true, "format": "Python", "description": "This file provides simple encryption and decryption functions using XOR cipher for at-rest data, intended as a mock or demo implementation. It includes functions for encrypting and decrypting strings, and references environment variables for secret management.", "external_files": ["base64", "os"], "external_methods": ["base64.urlsafe_b64encode", "base64.urlsafe_b64decode", "os.getenv"], "published": ["encrypt_str", "decrypt_str"], "classes": [], "methods": [{"name": "bytes _xor_bytes(data: bytes, key: bytes)", "description": "Performs XOR operation on each byte of data with the key, repeating the key as necessary.", "scope": "", "scopeKind": ""}, {"name": "str encrypt_str(plain: str)", "description": "Encrypts a string deterministically for at-rest storage (demo only) using XOR cipher and encodes it in base64.", "scope": "", "scopeKind": ""}, {"name": "str decrypt_str(token: str)", "description": "Decrypts a base64-encoded string that was encrypted with 'encrypt_str', reversing the XOR cipher.", "scope": "", "scopeKind": ""}], "calls": ["base64.urlsafe_b64encode", "base64.urlsafe_b64decode", "os.getenv"], "search-terms": ["crypto", "encryption", "XOR", "at-rest encryption", "demo", "base64", "env variable", "_xor_bytes"], "state": 2, "file_id": 6, "knowledge_revision": 13, "git_revision": "", "ctags": [{"_type": "tag", "name": "_SECRET", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/security/crypto.py", "pattern": "/^_SECRET = (os.getenv(\"ENC_KEY\") or \"dev-secret\").encode(\"utf-8\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_xor_bytes", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/security/crypto.py", "pattern": "/^def _xor_bytes(data: bytes, key: bytes) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "function", "signature": "(data: bytes, key: bytes)"}, {"_type": "tag", "name": "decrypt_str", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/security/crypto.py", "pattern": "/^def decrypt_str(token: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "encrypt_str", "path": "/home/kavia/workspace/code-generation/unified-integration-hub-144005-144014/unified_connector_backend/app/security/crypto.py", "pattern": "/^def encrypt_str(plain: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(plain: str)"}], "hash": "a12ea70fcd3972be86ba72947f4b2773", "format-version": 4, "code-base-name": "unified_connector_backend", "filename": "unified_connector_backend/app/security/crypto.py", "fields": [{"name": "_SECRET = (os.getenv(\"ENC_KEY\") or \"dev-secret\").encode(\"utf-8\")", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"13": ""}]}